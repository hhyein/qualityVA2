import React, { useEffect } from 'react'
import ApexCharts from 'apexcharts'

export default function HeatmapChart(props) {
  const { chartName, data } = props
  const d3 = window.d3v4

  useEffect(() => {
    if (!data || data.visualization != chartName)
      return;

    d3.select('.correlation-wrapper').selectAll('*').remove()

    var options = {
      //series: [{'name': 'r0', 'data': [1.0]}, {'name': 'r1', 'data': [0.0821666201880904, 1.0]}, {'name': 'r2', 'data': [0.08610236581521998, 0.5736944999046226, 1.0]}, {'name': 'r3', 'data': [-0.05065360296669657, 0.013547341092700874, -0.01558512944752652, 1.0]}, {'name': 'r4', 'data': [0.022419062575927583, 0.145317026490625, 0.2962295067166269, 0.02181618751951481, 1.0]}, {'name': 'r5', 'data': [0.003331575544599546, 0.024730768934785992, 0.01376486083701261, -0.006768432657304944, -0.013688194861188616, 1.0]}, {'name': 'r6', 'data': [0.08929565854790845, 0.36430551390255383, 0.8476643757918249, -0.02830596053155289, 0.29951513626467635, 0.009969484842204153, 1.0]}, {'name': 'r7', 'data': [-0.009211584119563932, 0.09769596084499002, 0.06624478643155432, -0.017227648017300215, 0.03772877446186255, 0.028228954172494387, 0.04125959009301699, 1.0]}, {'name': 'r8', 'data': [0.019403578712392473, -0.06923494761230978, -0.06004524367676903, 0.011454676391174628, -0.00011963718886740238, 0.0645644489267224, -0.050204709078034204, 0.0072030593908204744, 1.0]}, {'name': 'r9', 'data': [0.025698019086181554, 0.031983670497266546, 0.05790498550457126, -0.04158301897143458, -0.054658336580864816, 0.027012856823608218, 0.03523826898090249, -0.008436684062982017, -0.01147244988393661, 1.0]}, {'name': 'r10', 'data': [0.0046566795508345355, 0.05185024938087231, 0.0533358080664225, 0.011279941799365508, 0.014948234275594732, 0.01208673355635171, 0.05957217119203836, -0.03981303683170337, -0.028484624217907182, 0.04217388781866837, 1.0]}, {'name': 'r11', 'data': [0.019000753898586235, -0.022983464088278217, 0.03717584355855042, 0.013836023063703143, 0.019673624281148095, -0.008890981609330837, 0.05600331922226607, -0.015672125852012532, 0.013181670460643335, -0.01232260408188468, -0.04041522666369168, 1.0]}],
      series: data.seriesData,
      chart: {
        toolbar: {
          show: false
        },
        animations: {
          enabled: false
        },
        width: 230,
        height: 220,
        type: 'heatmap'
      },
      dataLabels: {
        enabled: false
      },
      xaxis: {
        categories: data.categoryData,
        tooltip: {
          enabled: false
        }
      },
      tooltip: {
        x: {
          show: true
        }
      },
      legend: {
        show: false
      },
      //colors: ["#6C757D"]
      plotOptions: {
        heatmap: {
          colorScale: {
            ranges: [
              {
                from: -1.0,
                to: -0.8,
                name: 'negative high',
                color: '#128FD9'
              }, {
                from: -0.8,
                to: 0.8,
                name: 'moderate',
                color: '#6C757D'
              }, {
                from: 0.8,
                to: 1.0,
                name: 'positive high',
                color: '#D91212'
              }
            ]
          }
        }
      }
    };

    var chart = new ApexCharts(document.querySelector(".correlation-wrapper"), options);
    chart.render();

  }, [data])

  return (
    <div className="correlation-wrapper" />
  )
}
